<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Growtopia Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #0f172a; color: white; }
    .login-box { background: #1e293b; border-radius: 12px; padding: 2rem; }
    .btn { background: linear-gradient(45deg, #00b8ff, #0056e0); padding: 0.75rem 1.5rem; border-radius: 8px; color: white; font-weight: bold; }
    .btn:hover { background: linear-gradient(45deg, #0056e0, #00b8ff); transform: scale(1.05); }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen">

  <div class="login-box max-w-md w-full">
    <h1 class="text-2xl font-bold mb-6 text-center">Growtopia Login</h1>

    <!-- GrowID Login Form -->
    <form action="/player/growid/login/validate" method="post" class="space-y-4">
      <input type="hidden" name="_token" value='<%= JSON.stringify(data || {}) %>' />

      <div>
        <label class="block text-sm mb-1">GrowID</label>
        <input type="text" name="growId" placeholder="Enter GrowID"
               class="w-full p-2 rounded bg-gray-700 border border-gray-600">
      </div>

      <div>
        <label class="block text-sm mb-1">Password</label>
        <input type="password" name="password" placeholder="Enter Password"
               class="w-full p-2 rounded bg-gray-700 border border-gray-600">
      </div>

      <div>
        <label class="block text-sm mb-1">Mode</label>
        <select name="type" class="w-full p-2 rounded bg-gray-700 border border-gray-600">
          <option value="login">Login</option>
          <option value="register">Register</option>
        </select>
      </div>

      <div>
        <label class="block text-sm mb-1">Server</label>
        <select id="serverSelect" name="port"
                class="w-full p-2 rounded bg-gray-700 border border-gray-600">
          <option value="">Loading servers...</option>
        </select>
      </div>

      <button type="submit" class="btn w-full">Login</button>
    </form>
  </div>

  <script>
    // Fetch servers from backend API
    async function loadServers() {
      try {
        const res = await fetch("/api/servers");
        const servers = await res.json();
        const select = document.getElementById("serverSelect");
        select.innerHTML = "";
        servers.forEach(s => {
          const opt = document.createElement("option");
          opt.value = s.port;
          opt.textContent = `${s.name} (${s.port})`;
          select.appendChild(opt);
        });
      } catch (err) {
        console.error("Failed to load servers:", err);
        document.getElementById("serverSelect").innerHTML =
          '<option value="">Error loading servers</option>';
      }
    }
    loadServers();
  </script>
</body>
</html>
